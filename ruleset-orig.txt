table ip filter {
	chain INPUT {
		type filter hook input priority filter; policy accept;
		counter packets 2269742 bytes 5609286175 jump nixos-fw
	}

	chain nixos-drop {
		counter packets 0 bytes 0 drop
	}

	chain nixos-fw-accept {
		counter packets 2265975 bytes 5608986584 accept
	}

	chain nixos-fw-refuse {
		counter packets 3767 bytes 299591 drop
	}

	chain nixos-fw-log-refuse {
		tcp flags & (fin | syn | rst | ack) == syn counter packets 0 bytes 0 # xt_LOG
		# xt_pkttype counter packets 3637 bytes 283499 jump nixos-fw-refuse
		counter packets 130 bytes 16092 jump nixos-fw-refuse
	}

	chain nixos-fw {
		iifname "lo" counter packets 2923 bytes 582127 jump nixos-fw-accept
		# xt_conntrack counter packets 2263052 bytes 5608404457 jump nixos-fw-accept
		meta l4proto icmp # xt_icmp counter packets 0 bytes 0 jump nixos-fw-accept
		counter packets 3767 bytes 299591 jump nixos-fw-log-refuse
	}
}
table ip6 filter {
	chain INPUT {
		type filter hook input priority filter; policy accept;
		counter packets 0 bytes 0 jump nixos-fw
	}

	chain nixos-drop {
		counter packets 0 bytes 0 drop
	}

	chain nixos-fw-accept {
		counter packets 0 bytes 0 accept
	}

	chain nixos-fw-refuse {
		counter packets 0 bytes 0 drop
	}

	chain nixos-fw-log-refuse {
		tcp flags & (fin | syn | rst | ack) == syn counter packets 0 bytes 0 # xt_LOG
		# xt_pkttype counter packets 0 bytes 0 jump nixos-fw-refuse
		counter packets 0 bytes 0 jump nixos-fw-refuse
	}

	chain nixos-fw {
		iifname "lo" counter packets 0 bytes 0 jump nixos-fw-accept
		# xt_conntrack counter packets 0 bytes 0 jump nixos-fw-accept
		meta l4proto ipv6-icmp # xt_icmp6 counter packets 0 bytes 0 drop
		meta l4proto ipv6-icmp # xt_icmp6 counter packets 0 bytes 0 drop
		meta l4proto ipv6-icmp counter packets 0 bytes 0 jump nixos-fw-accept
		@nh,192,64 18338657682652659712 udp dport 546 counter packets 0 bytes 0 jump nixos-fw-accept
		counter packets 0 bytes 0 jump nixos-fw-log-refuse
	}
}
table ip raw {
	chain nixos-fw-rpfilter {
		# xt_rpfilter counter packets 3962728 bytes 13449771024 return
		meta l4proto udp # xt_udp counter packets 107 bytes 35096 return
		meta l4proto udp ip saddr 0.0.0.0 ip daddr 255.255.255.255 # xt_udp counter packets 0 bytes 0 return
		counter packets 31 bytes 2613 drop
	}

	chain PREROUTING {
		type filter hook prerouting priority raw; policy accept;
		counter packets 3962866 bytes 13449808733 jump nixos-fw-rpfilter
	}
}
table ip6 raw {
	chain nixos-fw-rpfilter {
		# xt_rpfilter counter packets 16 bytes 1128 return
		counter packets 0 bytes 0 drop
	}

	chain PREROUTING {
		type filter hook prerouting priority raw; policy accept;
		counter packets 16 bytes 1128 jump nixos-fw-rpfilter
	}
}
table ip mangle {
	chain nixos-fw-rpfilter {
		# xt_rpfilter counter packets 2269742 bytes 5609286175 return
		udp sport 67 udp dport 68 counter packets 87 bytes 28536 return
		ip saddr 0.0.0.0 ip daddr 255.255.255.255 udp sport 68 udp dport 67 counter packets 0 bytes 0 return
		counter packets 0 bytes 0 drop
	}

	chain PREROUTING {
		type filter hook prerouting priority mangle; policy accept;
		counter packets 2269829 bytes 5609314711 jump nixos-fw-rpfilter
	}
}
table ip6 mangle {
	chain nixos-fw-rpfilter {
		# xt_rpfilter counter packets 0 bytes 0 return
		counter packets 0 bytes 0 drop
	}

	chain PREROUTING {
		type filter hook prerouting priority mangle; policy accept;
		counter packets 0 bytes 0 jump nixos-fw-rpfilter
	}
}
